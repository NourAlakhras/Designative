<!DOCTYPE html>
<html>

<head>
  <title>Profile Page</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/css/my_profile_style.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet" />
  <style>
    body {
      overflow-x: hidden;
      background: #f6f0f4 !important;
    }

    .btn {
      background-color: #c56b85;
      font-family: "Ysabeau";
    }

    .btn:hover {
      background: #345d7d;
    }

    #label {
      color: white;
      font-weight: bold;
    }

    body {
      overflow-x: hidden;
      background: #F6F0F4 !important;
    }

    .btn {
      background-color: #C56B85;
      font-family: 'Ysabeau';

    }

    .btn:hover {
      background: #345D7D;
    }

    #label {
      color: white;
      font-weight: bold;
    }

    .pointer {
      cursor: pointer;
    }

    .accordian-link h3 {
      font-size: 3.5em;
    }

    .review_answer {
      max-height: 10em;
      overflow-y: auto;
    }

    .review_answer::-webkit-scrollbar {
      width: 1.5em;
    }

    .review_answer::-webkit-scrollbar-track {
      border-radius: 8px;
    }

    .review_answer::-webkit-scrollbar-thumb {
      border-radius: 8px;
    }

    #review-username input:hover {
      background: #F6F0F4;
      color: #345D7D;
    }
  </style>
</head>

<body>
  <%- include('partials/nav-bar-auth.ejs') %>
    <!--profile menu to open & close-->
    <script>
      document
        .querySelector(".mini-photo-wrapper")
        .addEventListener("click", function () {
          document.querySelector(".menu-container").classList.toggle("active");
        });
    </script>

    <main style="font-size: 12px">
      <!--Page content-->
      <div class="container">
        <div class="main-body">
          <div class="row">
            <!--1st col from page-->
            <div class="col-md-4">
              <!--1st row-->
              <div class="card">
                <div class="card-body">
                  <!--general info-->
                  <div class="d-flex flex-column align-items-center text-center">
                    <div class="profile">
                      <label class="-label" for="fileprofile">
                        <ion-icon name="camera"></ion-icon>
                        <span>Change Image</span>
                      </label>
                      <input id="fileprofile" type="file" style="display: none" />
                      <img id="img" src="/images/customer.png" alt="Admin" class="rounded-circle p-1" width="110" />
                    </div>
                    <div class="mt-3">
                      <h4 style="font-weight: 700">
                        <%= user.firstname %>
                          <%= user.lastname %>
                      </h4>
                      <button class="btn">
                        <span id="label" style="font-size: 14px; font-weight: bold">Save Change</span>
                      </button>
                    </div>
                  </div>
                  <script>
                    //to allow the user choose the profile image
                    const image = document.getElementById("img"),
                      input = document.getElementById("fileprofile");

                    input.addEventListener("change", () => {
                      image.src = URL.createObjectURL(input.files[0]);
                    });
                  </script>
                </div>
              </div>
              <!--  -->
            </div>

            <!--2nd col of page-->
            <div class="col-md-8">
              <div class="card">
                <div class="card-body">
                  <form action="/updateAccount" method="post">
                    <!--form info: 1st row-->
                    <div class="row mb-3">
                      <div class="col-sm-3">
                        <h6 class="mb-0">First Name</h6>
                      </div>
                      <div class="col-sm-9 text-secondary">
                        <input name="firstname" type="text" class="form-control" value="<%= user.firstname %>"
                          style="font-size: medium" />
                      </div>
                    </div>
                    <div class="row mb-3">
                      <div class="col-sm-3">
                        <h6 class="mb-0">Last Name</h6>
                      </div>
                      <div class="col-sm-9 text-secondary">
                        <input name="lastname" type="text" class="form-control" value="<%= user.lastname %>"
                          style="font-size: medium" />
                      </div>
                    </div>

                    <div class="row mb-3">
                      <div class="col-sm-3">
                        <h6 class="mb-0">Email</h6>
                      </div>
                      <div class="col-sm-9 text-secondary">
                        <input name="email" type="text" class="form-control" value="<%= user.email %>"
                          style="font-size: medium" />
                      </div>
                    </div>

                    <div class="row mb-3">
                      <div class="col-sm-3">
                        <h6 class="mb-0">Phone</h6>
                      </div>
                      <div class="col-sm-9 text-secondary">
                        <input name="phoneNumber" type="text" class="form-control" value="<%= user.phoneNumber %>"
                          style="font-size: medium" />
                      </div>
                    </div>

                    <div class="row mb-3">
                      <div class="col-sm-3">
                        <h6 class="mb-0">Address</h6>
                      </div>
                      <div class="col-sm-9 text-secondary">
                        <input name="address" type="text" class="form-control" value="<%= user.address %>"
                          style="font-size: medium" />
                      </div>
                    </div>

                    <div class="row">
                      <div class="col-sm-3"></div>
                      <div class="col-sm-9 text-secondary">
                        <button class="btn" type="submit">
                          <span id="label" style="font-size: 14px; font-weight: bold">Save Changes</span>
                        </button>
                  </form>
                </div>
              </div>
            </div>
          </div>

          <!--project status: 2nd row-->

          <div class="row">
            <div class="col-sm-12">
              <div class="cards">
                <!--1st project example-->
                <% projects.forEach(project=> { %>

                  <div class="card twitter" id="Twitter">
                    <!--1st row to add project name & description-->
                    <div class="row">
                      <h2 class="card-title-large">
                        <%= project.name %>
                      </h2>
                      <!--project name & desc & edit button-->
                      <div class="col-sm-6">
                        <p style="font-size: 17px; text-align: left; font-weight: 700"
                          class="card-description text-dark">
                          <%= project.description %>
                        </p>
                        <a class="card-cta" role="button"
                          href="javascript:SwapDivsWithClick('swapper-first','swapper-other')">Edit</a>

                        <a class="card-cta" role="button" onclick="removeTwit('<%= project._id %>')">Delete</a>

                        <!--to allow edit project when user click on edit button-->
                        <script>
                          function SwapDivsWithClick() {
                            d1 = document.getElementById("Twitter");
                            d2 = document.getElementById("editTwitter");
                            if (d2.style.display == "none") {
                              d1.style.display = "none";
                              d2.style.display = "block";
                            } else {
                              d1.style.display = "block";
                              d2.style.display = "none";
                            }
                          }
                        </script>
                      </div>

                      <!--carusal/img related to project-->
                      <div class="col-sm-6">
                        <div id="carouselExampleControlsNoTouching" class="carousel slide" data-bs-touch="false"
                          data-bs-interval="false">
                          <div class="carousel-inner">
                            <!--1st img-->
                            <% project.images.forEach(image=> { %>
                              <div class="carousel-item active">
                                <img src="/images/<%= image %>" class="d-block w-100" alt="img1" height="200px;" />
                              </div>
                              <% }) %>
                          </div>
                          <!--the arrows for img to go back & forth-->
                          <button class="carousel-control-prev" type="button"
                            data-bs-target="#carouselExampleControlsNoTouching" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                          </button>
                          <button class="carousel-control-next" type="button"
                            data-bs-target="#carouselExampleControlsNoTouching" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!--Edit option for project EX#1-->
                  <div id="editTwitter" class="card twitter" style="display: none">
                    <div class="row">
                      <div class="col-sm-6">
                        <div class="listing-container">
                          <!--collect proj inf from user using a form-->
                          <form class="inputs-container">
                            <!--1st info: name of proj-->
                            <label style="color: #c56b85; font-size: 15px; font-weight: 400">ProjectName:
                              <input type="text" name="Name" class="simple-input" value="<%= project.name %>" />
                            </label>
                            <br /><br />
                            <!--2nd info: description of proj-->
                            <span data-label="Project Description:" class="input" role="textbox" contenteditable>
                              <%= project.description %>
                            </span>
                            <br /><br />
                          </form>
                        </div>
                      </div>

                      <!--2nd row: project img to fill-->
                      <div class="col-sm-6">
                        <!--4th info: img for proj using carousal-->
                        <span data-label="Image for your project:" style="color: #c56b85">
                          <div id="ed1" class="carousel slide" data-bs-touch="false" data-bs-interval="false">
                            <div class="carousel-inner">
                              <!--1st img-->
                              <div class="carousel-item active">
                                <div class="profile-pic">
                                  <label class="-label" for="fileTwit1">
                                    <ion-icon name="camera"></ion-icon>
                                    <span>Change Image</span>
                                  </label>
                                  <img src="/images/p1.png" id="twit1" width="100%" height="200" />
                                  <input id="fileTwit1" type="file" onchange="loadtwit1(event)" style="display: none" />
                                </div>
                              </div>

                              <!--to allow the user choose the image1-->
                              <script>
                                const loadtwit1 = function (event) {
                                  const imagetwit1 = document.getElementById("twit1");
                                  imagetwit1.src = URL.createObjectURL(
                                    event.target.files[0],
                                  );
                                };
                              </script>

                              <!--2nd img-->
                              <div class="carousel-item">
                                <div class="profile-pic">
                                  <label class="-label" for="fileTwit2">
                                    <ion-icon name="camera"></ion-icon>
                                    <span>Change Image</span>
                                  </label>
                                  <img src="/images/p2.png" id="twit2" width="100%" height="200" />
                                  <input id="fileTwit2" type="file" onchange="loadtwit2(event)" style="display: none" />
                                </div>
                              </div>

                              <!--to allow the user choose the image1-->
                              <script>
                                const loadtwit2 = function (event) {
                                  const imagetwit2 = document.getElementById("twit2");
                                  imagetwit2.src = URL.createObjectURL(
                                    event.target.files[0],
                                  );
                                };
                              </script>

                              <!--3rd img-->
                              <div class="carousel-item">
                                <div class="profile-pic">
                                  <label class="-label" for="fileTwit3">
                                    <ion-icon name="camera"></ion-icon>
                                    <span>Change Image</span>
                                  </label>
                                  <img src="/images/p3.png" id="twit3" width="100%" height="200" />
                                  <input id="fileTwit3" type="file" onchange="loadtwit3(event)" style="display: none" />
                                </div>
                              </div>

                              <!--to allow the user choose the image1-->
                              <script>
                                const loadtwit3 = function (event) {
                                  const imagetwit3 = document.getElementById("twit3");
                                  imagetwit3.src = URL.createObjectURL(
                                    event.target.files[0],
                                  );
                                };
                              </script>
                            </div>

                            <!--the arrows for img to go back & forth-->
                            <button class="carousel-control-prev" type="button" data-bs-target="#ed1"
                              data-bs-slide="prev">
                              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                              <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#ed1"
                              data-bs-slide="next">
                              <span class="carousel-control-next-icon" aria-hidden="true"></span>
                              <span class="visually-hidden">Next</span>
                            </button>
                          </div>
                        </span>
                      </div>
                      <p>
                        <!--button inside project form -->
                        <button class="btn">
                          <a id="label" style="
                                font-size: 14px;
                                font-weight: bold;
                                text-decoration: none;
                              " href="javascript:SwapDivsWithClick('swapper-first','swapper-other')">
                            Update Project
                          </a>
                        </button>
                      </p>
                      <!--To delete the 1st project-->
                      <script>
                        async function removeTwit(id) {
                          const res = await fetch(`http://localhost:5000/deleteProject/${id}`, { method: "POST" });
                          location.reload()
                        }
                      </script>
                    </div>
                  </div>
                  <% }) %>

                    <!-- ----------------------------------------------------------------------- -->
                    <!--ALLOWING USER TO ADD PROJECT: 4th project example-->
                    <div id="addP" class="card youtube">
                      <div class="row">
                        <!--1st row: project inf to fill-->
                        <div class="col-sm-6">
                          <div class="listing-container">
                            <!--collect proj inf from user using a form-->
                            <form class="inputs-container" action="/addProject" method="POST">
                              <!--1st info: name of proj-->
                              <label style="color: #c56b85; font-size: 15px; font-weight: 400">Project Name:
                                <input type="text" name="name" class="simple-input" placeholder="Project Name"
                                  required />
                              </label>
                              <br /><br />
                              <!--2nd info: description of proj-->
                              <span data-label="Project Description:">
                                <input type="text" name="description" placeholder="Project Description"
                                  class="js-sauce-name" style="color: #345d7d" />
                              </span>
                              <br /><br />
                              <!--3rd info: type of proj-->
                              <span data-label="Type of Your Project:">
                                <input type="checkbox" class="js-sauce-name" id="filmmaker" name="filmmaker"
                                  value="filmmaker" />
                                <label for="filmmaker" style="color: #345d7d">
                                  Filmmaker</label><br />
                                <input type="checkbox" class="js-sauce-name" id="webdes" name="webdes"
                                  value="Web Designer" />
                                <label for="webdes" style="color: #345d7d">
                                  Web Designer</label><br />
                                <input type="checkbox" class="js-sauce-name" id="branddes" name="branddes"
                                  value="Brand Designer" />
                                <label for="branddes" style="color: #345d7d">
                                  Brand Designer</label><br />
                                <input type="checkbox" class="js-sauce-name" id="vidgame" name="vidgame"
                                  value="Video Game" />
                                <label for="vidgame" style="color: #345d7d">
                                  Video Game</label><br />
                                <input type="checkbox" class="js-sauce-name" id="animator" name="animator"
                                  value="Animator" />
                                <label for="branddes" style="color: #345d7d">
                                  Animator</label><br />
                              </span>

                              <!--plus sign to add new field-->
                              <span class="js-add-sauce" style="border: none">
                                <a href="#addSauce"><i class="icon icon-add"></i></a>
                              </span>
                          </div>
                        </div>

                        <!--2nd row: project img to fill-->
                        <div class="col-sm-6" style="margin-top: 50px">
                          <!--4th info: img for proj using carousal-->
                          <span data-label="Image for your project:" style="color: #c56b85">
                            <div id="myCarousel" class="carousel slide" data-bs-touch="false" data-bs-interval="false">
                              <!-- Wrapper for slides -->
                              <div class="carousel-inner">
                                <!--1st img-->
                                <div class="carousel-item active">
                                  <div class="profile-pic">
                                    <label class="-label" for="fileadd1">
                                      <ion-icon name="camera"></ion-icon>
                                      <span>Add Image</span>
                                    </label>
                                    <img src="/images/img.png" id="addimg1" width="100%" height="200" />
                                    <input id="fileadd1" type="file" onchange="loadadd1(event)" style="display: none" />
                                  </div>
                                </div>

                                <!--to allow the user choose the image1-->
                                <script>
                                  const loadadd1 = function (event) {
                                    const imageAdd1 = document.getElementById("addimg1");
                                    imageAdd1.src = URL.createObjectURL(
                                      event.target.files[0],
                                    );
                                  };
                                </script>

                                <!--2nd img-->
                                <div class="carousel-item">
                                  <div class="profile-pic">
                                    <label class="-label" for="fileadd2">
                                      <ion-icon name="camera"></ion-icon>
                                      <span>Add Image</span>
                                    </label>
                                    <img src="/images/img.png" id="addimg2" width="100%" height="200" />
                                    <input id="fileadd2" type="file" onchange="loadadd2(event)" style="display: none" />
                                  </div>
                                </div>

                                <!--to allow the user choose the image1-->
                                <script>
                                  const loadadd2 = function (event) {
                                    const imageAdd2 = document.getElementById("addimg2");
                                    imageAdd2.src = URL.createObjectURL(
                                      event.target.files[0],
                                    );
                                  };
                                </script>

                                <!--3rd img-->
                                <div class="carousel-item">
                                  <div class="profile-pic">
                                    <label class="-label" for="fileadd3">
                                      <ion-icon name="camera"></ion-icon>
                                      <span>Add Image</span>
                                    </label>
                                    <img src="/images/img.png" id="addimg3" width="100%" height="200" />
                                    <input id="fileadd3" type="file" onchange="loadadd3(event)" style="display: none" />
                                  </div>
                                </div>

                                <!--to allow the user choose the image1-->
                                <script>
                                  const loadadd3 = function (event) {
                                    const imageAdd3 = document.getElementById("addimg3");
                                    imageAdd3.src = URL.createObjectURL(
                                      event.target.files[0],
                                    );
                                  };
                                </script>
                              </div>

                              <!-- Left and right arrows/controls -->
                              <!--the arrows for img to go back & forth-->
                              <button class="carousel-control-prev" type="button" data-bs-target="#myCarousel"
                                data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                              </button>
                              <button class="carousel-control-next" type="button" data-bs-target="#myCarousel"
                                data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                              </button>
                            </div>
                          </span>
                        </div>

                        <script>
                          //add more feilds in the form using plus sign
                          const addSauceButton =
                            document.querySelector(".js-add-sauce > a");
                          addSauceButton.onclick = (event) => {
                            event.preventDefault();

                            let inputs = document.querySelectorAll(".js-sauce-name"),
                              lastInput = inputs[inputs.length - 1],
                              addItems = true;

                            [].map.call(inputs, (input) => {
                              if (!input.value) {
                                addItems = false;
                                bounceEmptyInput(input);
                              } else {
                                input.style.animation = "none";
                              }
                            });

                            if (addItems) {
                              let listNode = document.createElement("span");
                              let inputNode = document.createElement("input");
                              inputNode.classList.add("js-sauce-name");
                              inputNode.placeholder = "Additional information:";
                              inputNode.name = "additionalInfo"
                              listNode.style.display = "none";
                              listNode.classList.add("awaiting-init");
                              listNode.appendChild(inputNode);

                              lastInput.parentNode.after(listNode);
                              setTimeout(() => {
                                let awaitInit = document.querySelector(".awaiting-init");
                                slideDown(awaitInit);
                                awaitInit.classList.remove("awaiting-init");
                              }, 100);
                            } else {
                              console.log("Unable to add field. One or more is empty.");
                            }
                          };

                          const bounceEmptyInput = (childEl) => {
                            childEl.parentNode.style.animation = "bounceError .8s ease";
                            childEl.style.animation = "editInput 1s infinite";
                            setTimeout(() => {
                              childEl.parentNode.style.animation = "none";
                            }, 850);
                          };

                          // Check each input if they are not empty
                          // Slide Function
                          let slideUp = (target, duration = 500) => {
                            target.style.transitionProperty = "height, margin, padding";
                            target.style.transitionDuration = duration + "ms";
                            target.style.boxSizing = "border-box";
                            target.style.height = target.offsetHeight + "px";
                            target.offsetHeight;
                            target.style.overflow = "hidden";
                            target.style.height = 0;
                            target.style.paddingTop = 0;
                            target.style.paddingBottom = 0;
                            target.style.marginTop = 0;
                            target.style.marginBottom = 0;
                            window.setTimeout(() => {
                              target.style.display = "none";
                              target.style.removeProperty("height");
                              target.style.removeProperty("padding-top");
                              target.style.removeProperty("padding-bottom");
                              target.style.removeProperty("margin-top");
                              target.style.removeProperty("margin-bottom");
                              target.style.removeProperty("overflow");
                              target.style.removeProperty("transition-duration");
                              target.style.removeProperty("transition-property");
                            }, duration);
                          };

                          let slideDown = (target, duration = 1000) => {
                            target.style.removeProperty("display");
                            let display = window.getComputedStyle(target).display;

                            if (display === "none") display = "flex";

                            target.style.display = display;
                            let height = target.offsetHeight;
                            target.style.overflow = "hidden";
                            target.style.height = 0;
                            target.style.paddingTop = 0;
                            target.style.paddingBottom = 0;
                            target.style.marginTop = 0;
                            target.style.marginBottom = 0;
                            target.offsetHeight;
                            target.style.boxSizing = "border-box";
                            target.style.transitionProperty = "height, margin, padding";
                            target.style.transitionDuration = duration + "ms";
                            target.style.height = height + "px";
                            target.style.removeProperty("padding-top");
                            target.style.removeProperty("padding-bottom");
                            target.style.removeProperty("margin-top");
                            target.style.removeProperty("margin-bottom");
                            window.setTimeout(() => {
                              target.style.removeProperty("height");
                              target.style.removeProperty("overflow");
                              target.style.removeProperty("transition-duration");
                              target.style.removeProperty("transition-property");
                            }, duration);
                          };
                          var slideToggle = (target, duration = 500) => {
                            if (window.getComputedStyle(target).display === "none") {
                              return slideDown(target, duration);
                            } else {
                              return slideUp(target, duration);
                            }
                          };
                        </script>

                        <!--button inside project form -->
                        <p>
                          <button class="btn" type="submit">
                            <span id="label" style="font-size: 14px; font-weight: bold">Submit Project</span>
                          </button>
                        </p>
                      </div>
                      </form>

                    </div>

                    <!--button to add new project-->
                    <button id="newP" class="btn">
                      <span id="label" style="font-size: 14px; font-weight: bold">Click to Add New Project</span>
                    </button>

                    <!--to allow adding new project-->
                    <script>
                      const btn = document.getElementById("newP");
                      btn.addEventListener("click", () => {
                        const form = document.getElementById("addP");

                        if (form.style.display == "block") {
                          // 👇️ this HIDES the form
                          form.style.display = "none";
                        } else {
                          // 👇️ this SHOWS the form
                          form.style.display = "block";
                        }
                      });
                    </script>
              </div>
            </div>
          </div>
        </div>
      </div>
      </div>
      </div>
    </main>

    <%- include('partials/footer.ejs') %>
</body>

</html>